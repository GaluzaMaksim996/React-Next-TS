import { useState } from 'react';
import { GetStaticProps } from 'next';
import { MenuItem } from '@/interface/menu.interface';
import axios from 'axios';
import Button from '@/components/Button/Button';
import Htag from '@/components/Htag/Htag';
import P from '@/components/P/P';
import Rating from '@/components/Rating/Rating';
import Tag from '@/components/Tag/Tag';
import withLayout from '@/layout/Layout';
import Head from 'next/head';

function Home({ menu }: HomeProps): JSX.Element {
  const [rating, setRating] = useState<number>(4);
  return (
    <>
      <Head>
        <title>MyTop - наш лучший топ</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
        <link rel="preconnect" href="https://fonts.gstatic.com" />
        <link rel="preconnect" href="https://mc.yandex.ru" />
        <link
          href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap"
          rel="stylesheet"
        />
      </Head>
      <div>
        <Htag tag="h1">Заголовок 1</Htag>
        <Htag tag="h2">Заголовок 2</Htag>
        <Htag tag="h3">Заголовок 3</Htag>

        <Button appearance="ghost">Кнопка1</Button>
        <Button appearance="primary">Кнопка2</Button>
        <Button appearance="ghost" arrow="down">
          Кнопка3
        </Button>
        <Button appearance="ghost" arrow="right">
          Кнопка3
        </Button>

        <P size="l">Параграф1</P>
        <P>Параграф2</P>
        <P size="s">Параграф3</P>

        <Tag color="ghost">ghost</Tag>
        <Tag color="red">red</Tag>
        <Tag color="grey">grey</Tag>
        <Tag color="green">green</Tag>
        <Tag color="primary">primary</Tag>

        <Rating rating={rating} isEditable setRating={setRating} />

        <ul>
          {menu.map((m) => (
            <li key={m._id.secondCategory}>{m._id.secondCategory}</li>
          ))}
        </ul>
      </div>
    </>
  );
}

export default withLayout(Home);

export const getStaticProps: GetStaticProps<HomeProps> = async () => {
  const firstCategory = 0;
  const { data: menu } = await axios.post<MenuItem[]>(
    process.env.NEXT_PUBLIC_DOMAIN + '/api/top-page/find',
    {
      firstCategory,
    },
  );

  return {
    props: {
      menu,
      firstCategory,
    },
  };
};

interface HomeProps extends Record<string, unknown> {
  menu: MenuItem[];
  firstCategory: number;
}
